#!/bin/rc

# Usage
#	wctl=`{wctl $wsys}

fn new {
	if(~ $1 -cd) {
		d=`{echo $2 | sed 's/-cd//'}
		cd $d
		shift 2
	}
	window -m $*
}

fn wctl {
	while (a=`{read})
		if (~ $a(1) new) $a
}

if(! ~ $1 '')
	wsys=$1
if(~ $wsys '')
	exit '$wsys not set'

# $pid should be the pid of the rc process
# launched by srv, but we don't know it.
# Instead, use the pid of this process as a
# semi-random id.

srvname=wctl.^$user^.^$pid
srv -eq wctl
echo /srv/^$srvname
